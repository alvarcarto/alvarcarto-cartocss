# Alvar Carto CartoCSS styles

![screenshot](docs/screenshot.png)

These are the CartoCSS map stylesheets for Alvar Carto. They are used to render maps, which you can see at https://design.alvarcarto.com.

Services which are using these styles:

* https://github.com/kimmobrunfeldt/alvarcarto-tile-service
* https://github.com/kimmobrunfeldt/alvarcarto-render-service

The scale of these styles is designed so that rendering to 256x256 pixels with
scale 1 provides correct result. When rendering the final posters, where canvas size
is thousands of pixels, we're applying a scale multiplier to mapnik rendering.

*Forked from: https://github.com/gravitystorm/openstreetmap-carto*

## Differences to original openstreetmap-carto project

* No labels or texts
* Roads, tunnels and bridges are shown already at zoom level 5 for artistic reasons
* Different postgis connection details
* Our customized country borders in project.mml (custom-alvar-countries)



## Usage

To compile CartoCSS projects to mapnik XML styles, run:

```bash
npm install
npm run build
```

Many warnings are generated by newer carto version, see: https://github.com/gravitystorm/openstreetmap-carto/issues/3183.

## Local development

First fetch data files for mapnik styles:

```bash
./tools/install.sh
```

Then run:

```bash
npm run watch
```

## Docker setup

To download data files

```bash
docker-compose run cartocss bash

# Note: for some reason get-shapefiles.py needs to be inside a directory, instead of being in the root
#       of the repo. Probably some bug in path joining code.
curl -o tools/get-shapefiles.py https://raw.githubusercontent.com/gravitystorm/openstreetmap-carto/master/scripts/get-shapefiles.py
python3 tools/get-shapefiles.py -f -d ../dist/data/
```

## CI setup

On each push to master, these mapnik styles are deployed to `alvar-map-qa` server.

## Debugging maps

To see exact names of data layers, use OpenStreeMap Editor: https://www.openstreetmap.org/edit. You need to login first.



